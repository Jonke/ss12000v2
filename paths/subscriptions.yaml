subscriptions:
  get:
    tags:
      - Prenumeration
      - Verktyg
    summary: Hämta en lista av prenumerationer.
    responses:
      "200":
        description: successful operation
        content:
          application/json:
            schema:
              $ref: "../Subscription.yaml#/Subscriptions"

  post:
    tags:
      - Prenumeration
      - Verktyg
    summary: Skapa en prenumeration
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: "../Subscription.yaml#/CreateSubscription"
            example:
              name: Nya
              target: https://pastebin/788
              resourceTypes:
                - Organsation
                - SchoolUnit
                - Person
                - Duty
              clientAuthenticationToken: HemLiGt
    callbacks:
      subscriptionEvent: # Event name
        "{$request.body#/target}": # The callback URL, Refers to the passed URL
          post:
            parameters:
              - in: header
                name: Authentication
                schema:
                  type: string
                  description: >
                    Bearer HemLiGt
            requestBody: # Contents of the callback message
              required: true
              content:
                application/json:
                  schema:
                    type: object
                    properties:
                      action:
                        type: string
                        enum:
                          - NewOrUpdate
                          - Deleted
                      list:
                        type: array
                        items:
                          type: object
                          properties:
                            resource:
                              $ref: "../common.yaml#/components/schemas/EndPointsEnum"
                            id:
                              type: array
                              items:
                                type: string
                                format: uuid

            responses: # Expected responses to the callback message
              "200":
                description: Your server returns this code if it accepts the callback

    responses:
      201:
        description: response of new object
        content:
          application/json:
            schema:
              $ref: "../Subscription.yaml#/Subscription"
      default:
        description: unexpected error
        content:
          application/json:
            schema:
              $ref: "../Subscription.yaml#/Error"

subscription_by_id:
  delete:
    tags:
      - Prenumeration
      - Verktyg
    summary: Ta bort en prenumeration
    parameters:
      - name: id
        in: path
        description: ID för prenumerationen som ska tas bort
        required: true
        schema:
          type: string
    responses:
      "204":
        description: Prenumeration borttagen.
      "400":
        description: Invalid id
      "403":
        description: Not authorised
      "404":
        description: Prenumeration not found
  get:
    tags:
      - Prenumeration
      - Verktyg
    summary: Hämta prenumeration baserat på ID
    parameters:
      - name: id
        in: path
        description: ID för prenumerationen som ska hämtas
        required: true
        schema:
          type: string
    responses:
      "200":
        description: successful operation
        content:
          application/json:
            schema:
              $ref: "../Subscription.yaml#/Subscription"
      "400":
        description: Invalid id supplied
      "403":
        description: Not authorised
      "404":
        description: Prenumeration not found
  patch:
    tags:
      - Prenumeration
      - Verktyg
    summary: Uppdatera expire time på prenumerationen baserat på ID
    parameters:
      - name: id
        in: path
        description: ID för prenumerationen som ska uppdateras
        required: true
        schema:
          type: string
    responses:
      "200":
        description: successful operation
        content:
          application/json:
            schema:
              $ref: "../Subscription.yaml#/Subscription"
      "400":
        description: Invalid id supplied
      "403":
        description: Not authorised
      "404":
        description: Prenumeration not found
